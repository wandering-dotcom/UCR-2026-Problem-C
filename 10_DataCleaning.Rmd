---
title: "10_DataCleaning.Rmd"
author: "Dana Van"
date: '2026-02-02'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error = TRUE)
```

# Installing the dataset
```{r}

DWTS_data <- read.csv("2026_MCM_Problem_C_Data.csv")
summary(DWTS_data)
```


# Eliminating missing observations
```{r}

DWTS_data_clean <- DWTS_data[apply(is.na(DWTS_data), MARGIN = 1, sum) == 0, ]

# Convert empty strings ("") to NA for factor/character columns
char_cols <- sapply(DWTS_data_clean, is.character)
DWTS_data_clean[char_cols] <- lapply(DWTS_data_clean[char_cols], function(x) {
  x[x == ""] <- NA
  return(x)
})

# Replace NA with "Unknown" for factor/character columns
factor_cols <- sapply(DWTS_data_clean, function(x) is.factor(x) || is.character(x))
DWTS_data_clean[factor_cols] <- lapply(DWTS_data_clean[factor_cols], function(x) {
  x <- addNA(as.factor(x))                 # convert to factor and add NA as level
  levels(x)[is.na(levels(x))] <- "Unknown" # rename NA level
  return(x)
})

# Exclude the judge scores first
score_cols <- grep("week.*_judge.*_score", names(DWTS_data_clean), value = TRUE)
report_cols <- setdiff(names(DWTS_data_clean), score_cols)
DWTS_report_data <- DWTS_data_clean[, report_cols]

# Identify factor/character vs numeric/integer
factor_cols <- names(DWTS_report_data)[sapply(DWTS_report_data, is.factor) | sapply(DWTS_report_data, is.character)]
numeric_cols <- names(DWTS_report_data)[sapply(DWTS_report_data, is.numeric) | sapply(DWTS_report_data, is.integer)]

# Summarize factor/character columns
factor_summary <- data.frame(
  Type = sapply(DWTS_report_data[factor_cols], class),
  Unique = sapply(DWTS_report_data[factor_cols], function(x) length(unique(x))),
  Most_Common = sapply(DWTS_report_data[factor_cols], function(x) {
    names(sort(table(x), decreasing = TRUE))[1]
  }),
  stringsAsFactors = FALSE
)

# Summarize integer columnds
numeric_summary <- data.frame(
  Type = sapply(DWTS_report_data[numeric_cols], class),
  Unique = sapply(DWTS_report_data[numeric_cols], function(x) length(unique(x))),
  Min = sapply(DWTS_report_data[numeric_cols], min, na.rm = TRUE),
  Max = sapply(DWTS_report_data[numeric_cols], max, na.rm = TRUE),
  Mean = round(sapply(DWTS_report_data[numeric_cols], mean, na.rm = TRUE), 2),
  Median = round(sapply(DWTS_report_data[numeric_cols], median, na.rm = TRUE), 2),
  stringsAsFactors = FALSE
)

# Factor summary PNG
factor_grob <- tableGrob(factor_summary)
png("DWTS_factor_summary.png", width = 1200, height = 800, res = 150)
grid.draw(factor_grob)
dev.off()

# Numeric summary PNG
numeric_grob <- tableGrob(numeric_summary)
png("DWTS_numeric_summary.png", width = 1200, height = 800, res = 150)
grid.draw(numeric_grob)
dev.off()

```


# Changing necessary variables to factor and other acceptable forms
```{r}

names(DWTS_data) <- gsub("/", "_", names(DWTS_data))

DWTS_data_clean$ballroom_partner <- factor(DWTS_data_clean$ballroom_partner)
DWTS_data_clean$celebrity_industry <- factor(DWTS_data_clean$celebrity_industry)
DWTS_data_clean$celebrity_homestate <- factor(DWTS_data_clean$celebrity_homestate)
DWTS_data_clean$celebrity_homecountry.region <- factor(DWTS_data_clean$celebrity_homecountry.region)

DWTS_data_clean$season<- factor(DWTS_data_clean$season)
DWTS_data_clean$results <- factor(DWTS_data_clean$results)
DWTS_data_clean$placement <- factor(DWTS_data_clean$placement)

DWTS_data[score_cols] <- lapply(DWTS_data[score_cols], as.factor)

```


# Save as a new csv file
```{r}

write.csv(DWTS_data_clean, "DWTS_data_clean.csv", row.names = FALSE)
```