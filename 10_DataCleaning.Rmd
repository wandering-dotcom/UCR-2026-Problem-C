---
title: "10_DataCleaning.Rmd"
author: "Dana Van"
date: '2026-02-02'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, error = TRUE)
```

# Installing the dataset
```{r}

DWTS_data <- read.csv("2026_MCM_Problem_C_Data.csv")
summary(DWTS_data)
```


# Eliminating missing observations
```{r}

DWTS_data_clean <- DWTS_data[apply(is.na(DWTS_data), MARGIN = 1, sum) == 0, ]

# Convert empty strings ("") to NA for factor/character columns
char_cols <- sapply(DWTS_data_clean, is.character)
DWTS_data_clean[char_cols] <- lapply(DWTS_data_clean[char_cols], function(x) {
  x[x == ""] <- NA
  return(x)
})

# Replace NA with "Unknown" for factor/character columns
factor_cols <- sapply(DWTS_data_clean, function(x) is.factor(x) || is.character(x))
DWTS_data_clean[factor_cols] <- lapply(DWTS_data_clean[factor_cols], function(x) {
  x <- addNA(as.factor(x))                 # convert to factor and add NA as level
  levels(x)[is.na(levels(x))] <- "Unknown" # rename NA level
  return(x)
})

# Remove columns where all values are NA
DWTS_data_clean <- DWTS_data_clean[, colSums(!is.na(DWTS_data_clean)) > 0]

# data visualization for DWTS_data_clean
DWTS_data_text <- capture.output(summary(DWTS_data_clean))
DWTS_data_grob <- grid.text(paste(DWTS_data_text, collapse = "\n"), x = 0.05, y = 0.95, just = "left")
png("DWTS_data_output.png", width = 800, height = 400, res = 150)
grid.draw(DWTS_data_grob)
dev.off()

```


# Changing necessary variables to factor and other acceptable forms
```{r}

names(DWTS_data) <- gsub("/", "_", names(DWTS_data))

DWTS_data_clean$ballroom_partner <- factor(DWTS_data_clean$ballroom_partner)
DWTS_data_clean$celebrity_industry <- factor(DWTS_data_clean$celebrity_industry)
DWTS_data_clean$celebrity_homestate <- factor(DWTS_data_clean$celebrity_homestate)
DWTS_data_clean$celebrity_homecountry.region <- factor(DWTS_data_clean$celebrity_homecountry.region)

DWTS_data_clean$season<- factor(DWTS_data_clean$season)
DWTS_data_clean$results <- factor(DWTS_data_clean$results)
DWTS_data_clean$placement <- factor(DWTS_data_clean$placement)

score_cols <- grep("week.*judge.*_score", names(DWTS_data), value = TRUE)
DWTS_data[score_cols] <- lapply(DWTS_data[score_cols], as.factor)

```


# Save as a new csv file
```{r}

write.csv(DWTS_data_clean, "DWTS_data_clean.csv", row.names = FALSE)
```